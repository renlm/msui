{"version":3,"file":"TimePickerFooter.js","sources":["../../../../../src/components/DateTimePickers/TimeRangePicker/TimePickerFooter.tsx"],"sourcesContent":["import { css, cx } from '@emotion/css';\nimport { isString } from 'lodash';\nimport React, { useCallback, useState } from 'react';\n\nimport { getTimeZoneInfo, GrafanaTheme2, TimeZone } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\n\nimport { useStyles2 } from '../../../themes';\nimport { t, Trans } from '../../../utils/i18n';\nimport { Button } from '../../Button';\nimport { Field } from '../../Forms/Field';\nimport { RadioButtonGroup } from '../../Forms/RadioButtonGroup/RadioButtonGroup';\nimport { Select } from '../../Select/Select';\nimport { TimeZonePicker } from '../TimeZonePicker';\nimport { TimeZoneDescription } from '../TimeZonePicker/TimeZoneDescription';\nimport { TimeZoneOffset } from '../TimeZonePicker/TimeZoneOffset';\nimport { TimeZoneTitle } from '../TimeZonePicker/TimeZoneTitle';\nimport { monthOptions } from '../options';\n\ninterface Props {\n  timeZone?: TimeZone;\n  fiscalYearStartMonth?: number;\n  timestamp?: number;\n  onChangeTimeZone: (timeZone: TimeZone) => void;\n  onChangeFiscalYearStartMonth?: (month: number) => void;\n}\n\nexport const TimePickerFooter = (props: Props) => {\n  const {\n    timeZone,\n    fiscalYearStartMonth,\n    timestamp = Date.now(),\n    onChangeTimeZone,\n    onChangeFiscalYearStartMonth,\n  } = props;\n  const [isEditing, setEditing] = useState(false);\n  const [editMode, setEditMode] = useState('tz');\n\n  const onToggleChangeTimeSettings = useCallback(\n    (event?: React.MouseEvent) => {\n      if (event) {\n        event.stopPropagation();\n      }\n      setEditing(!isEditing);\n    },\n    [isEditing, setEditing]\n  );\n\n  const style = useStyles2(getStyle);\n\n  if (!isString(timeZone)) {\n    return null;\n  }\n\n  const info = getTimeZoneInfo(timeZone, timestamp);\n\n  if (!info) {\n    return null;\n  }\n\n  return (\n    <div>\n      <section\n        aria-label={t('time-picker.footer.time-zone-selection', 'Time zone selection')}\n        className={style.container}\n      >\n        <div className={style.timeZoneContainer}>\n          <div className={style.timeZone}>\n            <TimeZoneTitle title={info.name} />\n            <div className={style.spacer} />\n            <TimeZoneDescription info={info} />\n          </div>\n          <TimeZoneOffset timeZone={timeZone} timestamp={timestamp} />\n        </div>\n        <div className={style.spacer} />\n        <Button\n          data-testid={selectors.components.TimeZonePicker.changeTimeSettingsButton}\n          variant=\"secondary\"\n          onClick={onToggleChangeTimeSettings}\n          size=\"sm\"\n        >\n          <Trans i18nKey=\"time-picker.footer.change-settings-button\">Change time settings</Trans>\n        </Button>\n      </section>\n      {isEditing ? (\n        <div className={style.editContainer}>\n          <div>\n            <RadioButtonGroup\n              value={editMode}\n              options={[\n                { label: t('time-picker.footer.time-zone-option', 'Time zone'), value: 'tz' },\n                { label: t('time-picker.footer.fiscal-year-option', 'Fiscal year'), value: 'fy' },\n              ]}\n              onChange={setEditMode}\n            ></RadioButtonGroup>\n          </div>\n          {editMode === 'tz' ? (\n            <section\n              data-testid={selectors.components.TimeZonePicker.containerV2}\n              className={cx(style.timeZoneContainer, style.timeSettingContainer)}\n            >\n              <TimeZonePicker\n                includeInternal={true}\n                onChange={(timeZone) => {\n                  onToggleChangeTimeSettings();\n\n                  if (isString(timeZone)) {\n                    onChangeTimeZone(timeZone);\n                  }\n                }}\n                onBlur={onToggleChangeTimeSettings}\n                menuShouldPortal={false}\n              />\n            </section>\n          ) : (\n            <section\n              data-testid={selectors.components.TimeZonePicker.containerV2}\n              className={cx(style.timeZoneContainer, style.timeSettingContainer)}\n            >\n              <Field\n                className={style.fiscalYearField}\n                label={t('time-picker.footer.fiscal-year-start', 'Fiscal year start month')}\n              >\n                <Select\n                  value={fiscalYearStartMonth}\n                  menuShouldPortal={false}\n                  options={monthOptions}\n                  onChange={(value) => {\n                    if (onChangeFiscalYearStartMonth) {\n                      onChangeFiscalYearStartMonth(value.value ?? 0);\n                    }\n                  }}\n                />\n              </Field>\n            </section>\n          )}\n        </div>\n      ) : null}\n    </div>\n  );\n};\n\nconst getStyle = (theme: GrafanaTheme2) => ({\n  container: css({\n    borderTop: `1px solid ${theme.colors.border.weak}`,\n    padding: '11px',\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  }),\n  editContainer: css({\n    borderTop: `1px solid ${theme.colors.border.weak}`,\n    padding: '11px',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  }),\n  spacer: css({\n    marginLeft: '7px',\n  }),\n  timeSettingContainer: css({\n    paddingTop: theme.spacing(1),\n  }),\n  fiscalYearField: css({\n    marginBottom: 0,\n  }),\n  timeZoneContainer: css({\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    flexGrow: 1,\n  }),\n  timeZone: css({\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'baseline',\n    flexGrow: 1,\n  }),\n});\n"],"names":["React","timeZone"],"mappings":"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"}