{"version":3,"file":"LocalStorageValueProvider.js","sources":["../../../../../../../src/gcopypaste/app/core/components/LocalStorageValueProvider/LocalStorageValueProvider.tsx"],"sourcesContent":["// Core Grafana history https://github.com/grafana/grafana/blob/v11.0.0-preview/public/app/core/components/LocalStorageValueProvider/LocalStorageValueProvider.tsx\nimport React, { useEffect, useState } from 'react';\n\nimport store from '../../store';\n\nexport interface Props<T> {\n  storageKey: string;\n  defaultValue: T;\n  children: (value: T, onSaveToStore: (value: T) => void, onDeleteFromStore: () => void) => React.ReactNode;\n}\n\nexport const LocalStorageValueProvider = <T,>(props: Props<T>) => {\n  const { children, storageKey, defaultValue } = props;\n\n  const [state, setState] = useState({ value: store.getObject(props.storageKey, props.defaultValue) });\n\n  useEffect(() => {\n    const onStorageUpdate = (v: StorageEvent) => {\n      if (v.key === storageKey) {\n        setState({ value: store.getObject(props.storageKey, props.defaultValue) });\n      }\n    };\n\n    window.addEventListener('storage', onStorageUpdate);\n\n    return () => {\n      window.removeEventListener('storage', onStorageUpdate);\n    };\n  });\n\n  const onSaveToStore = (value: T) => {\n    try {\n      store.setObject(storageKey, value);\n    } catch (error) {\n      console.error(error);\n    }\n    setState({ value });\n  };\n\n  const onDeleteFromStore = () => {\n    try {\n      store.delete(storageKey);\n    } catch (error) {\n      console.log(error);\n    }\n    setState({ value: defaultValue });\n  };\n\n  return <>{children(state.value, onSaveToStore, onDeleteFromStore)}</>;\n};\n"],"names":[],"mappings":";;;AAWa,MAAA,yBAAA,GAA4B,CAAK,KAAoB,KAAA;AAChE,EAAA,MAAM,EAAE,QAAA,EAAU,UAAY,EAAA,YAAA,EAAiB,GAAA,KAAA,CAAA;AAE/C,EAAA,MAAM,CAAC,KAAA,EAAO,QAAQ,CAAA,GAAI,SAAS,EAAE,KAAA,EAAO,KAAM,CAAA,SAAA,CAAU,KAAM,CAAA,UAAA,EAAY,KAAM,CAAA,YAAY,GAAG,CAAA,CAAA;AAEnG,EAAA,SAAA,CAAU,MAAM;AACd,IAAM,MAAA,eAAA,GAAkB,CAAC,CAAoB,KAAA;AAC3C,MAAI,IAAA,CAAA,CAAE,QAAQ,UAAY,EAAA;AACxB,QAAS,QAAA,CAAA,EAAE,OAAO,KAAM,CAAA,SAAA,CAAU,MAAM,UAAY,EAAA,KAAA,CAAM,YAAY,CAAA,EAAG,CAAA,CAAA;AAAA,OAC3E;AAAA,KACF,CAAA;AAEA,IAAO,MAAA,CAAA,gBAAA,CAAiB,WAAW,eAAe,CAAA,CAAA;AAElD,IAAA,OAAO,MAAM;AACX,MAAO,MAAA,CAAA,mBAAA,CAAoB,WAAW,eAAe,CAAA,CAAA;AAAA,KACvD,CAAA;AAAA,GACD,CAAA,CAAA;AAED,EAAM,MAAA,aAAA,GAAgB,CAAC,KAAa,KAAA;AAClC,IAAI,IAAA;AACF,MAAM,KAAA,CAAA,SAAA,CAAU,YAAY,KAAK,CAAA,CAAA;AAAA,aAC1B,KAAO,EAAA;AACd,MAAA,OAAA,CAAQ,MAAM,KAAK,CAAA,CAAA;AAAA,KACrB;AACA,IAAS,QAAA,CAAA,EAAE,OAAO,CAAA,CAAA;AAAA,GACpB,CAAA;AAEA,EAAA,MAAM,oBAAoB,MAAM;AAC9B,IAAI,IAAA;AACF,MAAA,KAAA,CAAM,OAAO,UAAU,CAAA,CAAA;AAAA,aAChB,KAAO,EAAA;AACd,MAAA,OAAA,CAAQ,IAAI,KAAK,CAAA,CAAA;AAAA,KACnB;AACA,IAAS,QAAA,CAAA,EAAE,KAAO,EAAA,YAAA,EAAc,CAAA,CAAA;AAAA,GAClC,CAAA;AAEA,EAAA,iEAAU,QAAS,CAAA,KAAA,CAAM,KAAO,EAAA,aAAA,EAAe,iBAAiB,CAAE,CAAA,CAAA;AACpE;;;;"}