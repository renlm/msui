{"version":3,"file":"uFuzzy.js","sources":["../../../../../src/querybuilder/components/metrics-modal/uFuzzy.ts"],"sourcesContent":["// Core Grafana history https://github.com/grafana/grafana/blob/v11.0.0-preview/public/app/plugins/datasource/prometheus/querybuilder/components/metrics-modal/uFuzzy.ts\nimport uFuzzy from '@leeoniya/ufuzzy';\nimport { debounce as debounceLodash } from 'lodash';\n\nconst uf = new uFuzzy({\n  intraMode: 1,\n  intraIns: 1,\n  intraSub: 1,\n  intraTrn: 1,\n  intraDel: 1,\n});\n\nexport function fuzzySearch(haystack: string[], query: string, dispatcher: (data: string[][]) => void) {\n  const [idxs, info, order] = uf.search(haystack, query, 0, 1e5);\n\n  let haystackOrder: string[] = [];\n  let matchesSet: Set<string> = new Set();\n  if (idxs && order) {\n    /**\n     * get the fuzzy matches for hilighting\n     * @param part\n     * @param matched\n     */\n    const mark = (part: string, matched: boolean) => {\n      if (matched) {\n        matchesSet.add(part);\n      }\n    };\n\n    // Iterate to create the order of needles(queries) and the matches\n    for (let i = 0; i < order.length; i++) {\n      let infoIdx = order[i];\n\n      /** Evaluate the match, get the matches for highlighting */\n      uFuzzy.highlight(haystack[info.idx[infoIdx]], info.ranges[infoIdx], mark);\n      /** Get the order */\n      haystackOrder.push(haystack[info.idx[infoIdx]]);\n    }\n\n    dispatcher([haystackOrder, [...matchesSet]]);\n  } else if (!query) {\n    dispatcher([[], []]);\n  }\n}\n\nexport const debouncedFuzzySearch = debounceLodash(fuzzySearch, 300);\n"],"names":["debounceLodash"],"mappings":";;;AAIA,MAAM,EAAA,GAAK,IAAI,MAAO,CAAA;AAAA,EACpB,SAAW,EAAA,CAAA;AAAA,EACX,QAAU,EAAA,CAAA;AAAA,EACV,QAAU,EAAA,CAAA;AAAA,EACV,QAAU,EAAA,CAAA;AAAA,EACV,QAAU,EAAA,CAAA;AACZ,CAAC,CAAA,CAAA;AAEe,SAAA,WAAA,CAAY,QAAoB,EAAA,KAAA,EAAe,UAAwC,EAAA;AACrG,EAAM,MAAA,CAAC,IAAM,EAAA,IAAA,EAAM,KAAK,CAAA,GAAI,GAAG,MAAO,CAAA,QAAA,EAAU,KAAO,EAAA,CAAA,EAAG,GAAG,CAAA,CAAA;AAE7D,EAAA,IAAI,gBAA0B,EAAC,CAAA;AAC/B,EAAI,IAAA,UAAA,uBAA8B,GAAI,EAAA,CAAA;AACtC,EAAA,IAAI,QAAQ,KAAO,EAAA;AAMjB,IAAM,MAAA,IAAA,GAAO,CAAC,IAAA,EAAc,OAAqB,KAAA;AAC/C,MAAA,IAAI,OAAS,EAAA;AACX,QAAA,UAAA,CAAW,IAAI,IAAI,CAAA,CAAA;AAAA,OACrB;AAAA,KACF,CAAA;AAGA,IAAA,KAAA,IAAS,CAAI,GAAA,CAAA,EAAG,CAAI,GAAA,KAAA,CAAM,QAAQ,CAAK,EAAA,EAAA;AACrC,MAAI,IAAA,OAAA,GAAU,MAAM,CAAC,CAAA,CAAA;AAGrB,MAAO,MAAA,CAAA,SAAA,CAAU,QAAS,CAAA,IAAA,CAAK,GAAI,CAAA,OAAO,CAAC,CAAA,EAAG,IAAK,CAAA,MAAA,CAAO,OAAO,CAAA,EAAG,IAAI,CAAA,CAAA;AAExE,MAAA,aAAA,CAAc,KAAK,QAAS,CAAA,IAAA,CAAK,GAAI,CAAA,OAAO,CAAC,CAAC,CAAA,CAAA;AAAA,KAChD;AAEA,IAAA,UAAA,CAAW,CAAC,aAAe,EAAA,CAAC,GAAG,UAAU,CAAC,CAAC,CAAA,CAAA;AAAA,GAC7C,MAAA,IAAW,CAAC,KAAO,EAAA;AACjB,IAAA,UAAA,CAAW,CAAC,EAAI,EAAA,EAAE,CAAC,CAAA,CAAA;AAAA,GACrB;AACF,CAAA;AAEa,MAAA,oBAAA,GAAuBA,QAAe,CAAA,WAAA,EAAa,GAAG;;;;"}