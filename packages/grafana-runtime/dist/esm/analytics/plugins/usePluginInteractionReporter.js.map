{"version":3,"file":"usePluginInteractionReporter.js","sources":["../../../../src/analytics/plugins/usePluginInteractionReporter.ts"],"sourcesContent":["import { useMemo } from 'react';\n\nimport { isDataSourcePluginContext, usePluginContext } from '@grafana/data';\n\nimport { reportInteraction } from '../utils';\n\nimport { createDataSourcePluginEventProperties, createPluginEventProperties } from './eventProperties';\n\nconst namePrefix = 'grafana_plugin_';\n\nexport function usePluginInteractionReporter(): typeof reportInteraction {\n  const context = usePluginContext();\n\n  return useMemo(() => {\n    const info = isDataSourcePluginContext(context)\n      ? createDataSourcePluginEventProperties(context.instanceSettings)\n      : createPluginEventProperties(context.meta);\n\n    return (interactionName: string, properties?: Record<string, unknown>) => {\n      if (!validInteractionName(interactionName)) {\n        throw new Error(`Interactions reported in plugins should start with: \"${namePrefix}\".`);\n      }\n      return reportInteraction(interactionName, { ...properties, ...info });\n    };\n  }, [context]);\n}\n\nfunction validInteractionName(interactionName: string): boolean {\n  return interactionName.startsWith(namePrefix) && interactionName.length > namePrefix.length;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAQA,MAAM,UAAa,GAAA,iBAAA,CAAA;AAEZ,SAAS,4BAAyD,GAAA;AACvE,EAAA,MAAM,UAAU,gBAAiB,EAAA,CAAA;AAEjC,EAAA,OAAO,QAAQ,MAAM;AACnB,IAAM,MAAA,IAAA,GAAO,yBAA0B,CAAA,OAAO,CAC1C,GAAA,qCAAA,CAAsC,QAAQ,gBAAgB,CAAA,GAC9D,2BAA4B,CAAA,OAAA,CAAQ,IAAI,CAAA,CAAA;AAE5C,IAAO,OAAA,CAAC,iBAAyB,UAAyC,KAAA;AACxE,MAAI,IAAA,CAAC,oBAAqB,CAAA,eAAe,CAAG,EAAA;AAC1C,QAAA,MAAM,IAAI,KAAA,CAAM,CAAwD,qDAAA,EAAA,UAAU,CAAI,EAAA,CAAA,CAAA,CAAA;AAAA,OACxF;AACA,MAAA,OAAO,iBAAkB,CAAA,eAAA,EAAiB,cAAK,CAAA,cAAA,CAAA,EAAA,EAAA,UAAA,CAAA,EAAe,IAAM,CAAA,CAAA,CAAA;AAAA,KACtE,CAAA;AAAA,GACF,EAAG,CAAC,OAAO,CAAC,CAAA,CAAA;AACd,CAAA;AAEA,SAAS,qBAAqB,eAAkC,EAAA;AAC9D,EAAA,OAAO,gBAAgB,UAAW,CAAA,UAAU,CAAK,IAAA,eAAA,CAAgB,SAAS,UAAW,CAAA,MAAA,CAAA;AACvF;;;;"}